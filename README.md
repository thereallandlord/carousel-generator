# Carousel Generator v3

Полноценный генератор Instagram каруселей с визуальным редактором.

## Что умеет:

- ✅ Визуальный редактор шаблонов в браузере
- ✅ Drag & drop элементов
- ✅ Разные шрифты, размеры, жирность
- ✅ Фото-фон или цвет для каждого слайда отдельно
- ✅ Затемнение: полное ИЛИ градиент снизу
- ✅ Переменные: {PHOTO}, {TITLE}, {CONTENT} — подставляются при генерации
- ✅ Сохранение шаблонов на сервере
- ✅ API для N8N

---

## Установка на Railway

### 1. Создай новый проект на Railway

### 2. Загрузи файлы:
```
main.py
requirements.txt
static/
  index.html
```

### 3. Railway автоматически задеплоит

### 4. Открой URL — попадёшь в редактор

---

## Как пользоваться

### Редактор (веб-интерфейс)

1. Открой `https://твой-проект.railway.app/`
2. Создай шаблон:
   - Добавь слайды кнопкой "+"
   - На каждом слайде настрой фон (цвет или фото)
   - Добавь текстовые элементы
   - Используй переменные: `{PHOTO}`, `{TITLE}`, `{CONTENT}`, `{HIGHLIGHT}`
3. Нажми "Сохранить"

### Переменные в шаблонах

| Переменная | Описание |
|------------|----------|
| `{USERNAME}` | Автоматически — никнейм из настроек |
| `{SLIDE_NUM}` | Автоматически — номер слайда (1/10) |
| `{PHOTO}` | URL фото — передаёшь при генерации |
| `{TITLE}` | Заголовок — передаёшь при генерации |
| `{CONTENT}` | Текст — передаёшь при генерации |
| `{HIGHLIGHT}` | Выделенный текст — передаёшь при генерации |
| `{ЛЮБОЕ_ИМЯ}` | Любая своя переменная |

### API для N8N

**POST /generate**

```json
{
  "template_name": "Мой шаблон",
  "variables": {
    "PHOTO": "https://example.com/photo.jpg",
    "TITLE": "Заголовок карусели",
    "CONTENT": "Основной текст",
    "HIGHLIGHT": "Выделенный текст"
  }
}
```

**Ответ:**
```json
{
  "success": true,
  "message": "Создано 5 слайдов",
  "slides": [
    {
      "slide_number": 1,
      "base64": "data:image/png;base64,..."
    }
  ]
}
```

---

## N8N Workflow

```
[Telegram: фото + тема]
    ↓
[Claude: генерирует тексты]
    ↓
[HTTP Request: POST /generate]
    {
      "template_name": "bankomat",
      "variables": {
        "PHOTO": "{{ URL фото из Telegram }}",
        "TITLE": "{{ от Claude }}",
        "CONTENT": "{{ от Claude }}",
        "HIGHLIGHT": "{{ от Claude }}"
      }
    }
    ↓
[Telegram: отправляем slides[].base64]
```

---

## Примеры шаблонов

### Шаблон "Новость" (3 слайда)

**Слайд 1 (обложка):**
- Фон: {PHOTO} с затемнением 40%
- Текст: {TITLE} — крупный, снизу
- Текст: {HIGHLIGHT} — с жёлтым фоном

**Слайд 2 (контент):**
- Фон: белый
- Текст: {CONTENT} — обычный

**Слайд 3 (CTA):**
- Фон: белый
- Текст: {CTA_TITLE}
- Текст: {CTA_HIGHLIGHT} — с жёлтым фоном

### При генерации передаёшь:
```json
{
  "template_name": "Новость",
  "variables": {
    "PHOTO": "https://...",
    "TITLE": "Россия отменяет визы",
    "HIGHLIGHT": "с Саудовской Аравией?",
    "CONTENT": "27 ноября правительство одобрило...",
    "CTA_TITLE": "Хочешь подробности?",
    "CTA_HIGHLIGHT": "Пиши ВИЗА"
  }
}
```

---

## Структура проекта

```
carousel_full/
├── main.py           # API сервер
├── requirements.txt  # Зависимости
├── static/
│   └── index.html    # Веб-редактор
├── templates/        # Сохранённые шаблоны (JSON)
├── fonts/            # Шрифты (опционально)
└── output/           # Сгенерированные картинки
```
